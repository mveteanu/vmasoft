<script src="../lib/p5.js"></script>
<script src="../lib/p5.sound_.js"></script>
<!-- <script src="../lib/Tone.min.js"></script> -->
<script src="../lib/temp/Tone.js"></script>


<script>

// Should check: https://p5js.org/assets/p5_featured/maya-dulynoted/ and http://keyuguo.net/MoolodyWebVersion/sketch.js

// Also check this article about retro music with tone.js: https://codepen.io/gregh/post/recreating-legendary-8-bit-games-music-with-web-audio-api

function keyPressed()
{
    if (key == "Z")
    {
        fill("green");
        ellipse(100, 100, 10);

        initSynth();
    }
    else if (key == "X")
    {
        fill("red");
        ellipse(100, 100, 10);

        disposeSynth();
    }
}

function setup()
{
    createCanvas(300, 300);
    background(100);
}

function mouseClicked()
{
    beep("A4", 0);
    beep("C4", 0.3);
    beep("G4", 0.6);
}


var synth = null;

function initSynth()
{
    // create a synth and connect it to the master output (your speakers)
    //var synth = new Tone.Synth().toMaster();
    synth = new Tone.PolySynth(5, Tone.Synth).toMaster();
}

function disposeSynth()
{
    if (!synth)
        return;

    synth.disconnect();
    synth.dispose();
    synth = null;
}

function beep(note, tFromNow, duration)
{
    if (!synth)
        return;

    tFromNow = typeof tFromNow === "string" ? tFromNow : Tone.context.currentTime + (tFromNow || 0);
    tFromNow = tFromNow || 0;
    synth.triggerAttackRelease(note, duration || "8n", tFromNow);
}


</script>
