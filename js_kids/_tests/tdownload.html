
<script src="lib/p5.js"></script>
<script src="lib/p5.sound.js"></script>
<script src="lib/p5.play_.js"></script>

<script src="runtime/AssetsFinder.js"></script>
<script src="runtime/AssetsCache.js"></script>

<script>

var arImages = [ "img/dodo2.png", 
                "img/windmill.png", 
                "img/windmill.png", 
                "assets/backgrounds/clouds.png",
                "assets/sprites/asterisk_circle0000.png",
                "assets/sprites/cloud_breathing0001.png" ];
                
var arSounds = [ "assets/sounds/doorbell.mp3" ];

var oAssetsCache;

function setup()
{
    createCanvas(800, 600);
    background("lightblue");
    
    oAssetsCache = AssetsCache();
    //oAssetsCache.downloadImages(arImages, onDownload, onDownloadError);
    //oAssetsCache.downloadSounds(arSounds, onDownload, onDownloadError);

    oAssetsCache.downloadAssets(arImages, arSounds, onDownload, onDownloadError);
}

function mouseClicked()
{

    var i = oAssetsCache.getImageCount();
    if (i > 0)
    {
        i = getRandom(0, i);
        var img = oAssetsCache.getImage(i);
        image(img, mouseX, mouseY, 100, 100);
    }

    var j = oAssetsCache.getSoundCount();
    if (j > 0)
    {
        j = getRandom(0,  j );
        var sound = oAssetsCache.getSound(j);
        sound.play();
    }
}

function onDownload()
{
    console.log("Download completed. Images: " + oAssetsCache.getImageCount() + " Sounds: " + oAssetsCache.getSoundCount() );

    oAssetsCache.downloadImages(["assets/sprites/asterisk_circle0002.png", "assets/sprites/asterisk_circle0003.png"], onDownload_, onDownloadError);
}

function onDownload_()
{
    console.log("Download completed. Images: " + oAssetsCache.getImageCount() + " Sounds: " + oAssetsCache.getSoundCount() );
}

function onDownloadError()
{
    console.log("some errors occured...");
}

function getRandom(min, max) 
{
    return Math.floor(Math.random() * (max - min) ) + min;
}
</script>
