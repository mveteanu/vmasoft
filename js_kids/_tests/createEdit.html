<script src="lib/p5.js"></script>
<script src="lib/p5.sound.js"></script>
<script src="lib/p5.play_.js"></script>

<body>

<h1>Test HTML Elements</h1>

<div id="outputarea_" style='border:1px solid red; width: 800px; height:600px; padding:10px;'>
    <div id="outputarea" style="position: absolute; overflow: hidden; border:1px solid green;"></div>
</div>

<script>

var sketchCanvas;

var txt;
var txt2;
var txt3;

function setup()
{
    sketchCanvas = createCanvas(800, 600);
    parentCanvas(sketchCanvas);

    background("LightBlue");

    txt = createEdit(10, 10, 100);
    txt.setText("Hello");

    txt2 = createEdit(10, 50);
    txt2.value = txt.value;

    txt3 = createEdit(10, 100, 300, 100);
    txt3.readOnly = true;
}

function draw()
{
    if (mouseIsPressed)
        line(pmouseX, pmouseY, mouseX, mouseY);
}

function keyPressed()
{
    if (keyCode === ENTER)
    {
        text(txt.value, random(width), random(height));
        txt3.addLine(txt.value);
    }
}


function parentCanvas(canvas)
{
    var div = document.getElementById("outputarea");
    if (!div)
        return;

    div.oncontextmenu = function(){
        return false;
    }

    canvas.parent(div.id);
}


// =====================================


function createEdit(x, y, w, h)
{
    var el;
    var type;

    _init();
    return _return();

    function _init()
    {
        type = h ? "TEXTAREA" : "INPUT"
        el = document.createElement(type);
        el.setAttribute("type", "text");
        el.style.position = "absolute";

        if (!x && !y)
        {
            x = 0;
            y = 0;
        }

        if (!w)
        {
            w = 175;
        }

        el.style.left = x + 'px';
        el.style.top = y + 'px';
        el.style.width = w + 'px';

        if (h)
        {
            el.style.resize = "none";
            el.style.height = h + "px";
        }

        setVisible(true);

        var div = window.canvas.parentElement;
        div.appendChild(el);
    }

    function setVisible(visible)
    {
        el.style.display = visible ? "block" : "none";
    }

    function isVisible()
    {
        return el.style.display === "block";
    }

    function getText()
    {
        return el.value;
    }

    function setText(text)
    {
        el.value = text;
    }

    function setPosition(x, y)
    {
        el.style.left = x + 'px';
        el.style.top = y + 'px';
    }

    function setWidth(value)
    {
        el.style.width = value + 'px';
    }

    function getWidth()
    {
        return el.offsetWidth;
    }

    function setHeight(value)
    {
        if (type === "TEXTAREA")
            el.style.height = value + 'px';
    }

    function getHeight()
    {
        return el.offsetHeight;
    }

    function addLine(txt) 
    {
        el.value += txt + "\n";
    }

    function getEl()
    {
        return el;
    }

    function _return()
    {
        var oReturn = {
            getText : getText,
            setText : setText,
            addLine : addLine,
            setPosition : setPosition,
            getEl : getEl
        };

        Object.defineProperties(oReturn, { 
            "value" : {
                get() { return oReturn.getText(); },
                set(value) { oReturn.setText(value); }
                },
            "readOnly" : {
                get() { return el.readOnly; },
                set(value) { el.readOnly = value; }
                },
            "visible" : {
                get() { return isVisible(); },
                set(value) { setVisible(value); }
                },
            "width" : {
                get() { return getWidth(); },
                set(value) { setWidth(value); }
                },
            "height" : {
                get() { return getHeight(); },
                set(value) { setHeight(value); }
                }
            });

        return oReturn;
    }
}


function createInput(x, y, w)
{
    return createText("INPUT", x, y, w);
}

function createTextArea(x, y, w, h)
{
    var o = createText("TEXTAREA", x, y, w, h);

    o.getEl().style.resize = "none";

    if (h)
    {
        o.getEl().style.height = h + "px";
    }

    o.addLine = function(txt) {
        o.value += txt + "\n";
    }

    return o;
}


function createText(type, x, y, w)
{
    var el = _init();
    return _return();

    function _init()
    {
        var el = document.createElement(type);
        el.setAttribute("type", "text");
        el.style.position = 'absolute';

        if (!x && !y)
        {
            x = 0;
            y = 0;
        }

        if (!w)
        {
            w = 175;
        }

        el.style.left = x + 'px';
        el.style.top = y + 'px';
        el.style.width = w + 'px';

        var div = canvas.parentElement;
        div.appendChild(el);

        return el;
    }

    function setVisible(visible)
    {
        el.style.display = visible ? "block" : "none";
    }

    function getText()
    {
        return el.value;
    }

    function setText(text)
    {
        el.value = text;
    }

    function setPosition(x, y)
    {
        el.style.left = x + 'px';
        el.style.top = y + 'px';
    }

    function setWidth(w)
    {
        el.style.width = w + 'px';
    }

    function getEl()
    {
        return el;
    }

    function _return()
    {
        var oReturn = {
            setVisible : setVisible,
            getText : getText,
            setText : setText,
            setPosition : setPosition,
            setWidth : setWidth,
            getEl : getEl
        };

        Object.defineProperties(oReturn, { 
            "value" : {
                get() { return oReturn.getText(); },
                set(value) { oReturn.setText(value); }
                },
            "readOnly" : {
                get() { return el.readOnly; },
                set(value) { el.readOnly = value; }
                }
            });

        return oReturn;
    }
}


</script>
</body>
