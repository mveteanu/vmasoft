<script src="lib/p5.js"></script>
<script src="lib/p5.play.js"></script>
<script>

var scenes = [];
var currScene = 0;

function redefine_background()
{
    window.p5background = window.background;
    window.background = function() { 
                    if (arguments.length > 0 ) window.p5backgroundArgs = arguments; 
                    if (window.p5backgroundArgs != null) window.p5background.apply(this._renderer, window.p5backgroundArgs); 
                    }
}

function stamp(x, y)
{
    var animation = loadAnimation('assets/asterisk_circle0000.png', 'assets/asterisk_circle0008.png');
    animatedSprite = createSprite(x, y);
    animatedSprite.addAnimation("floating", animation);

    return animatedSprite;
}

function show(scene)
{

}

function preload()
{
}


function setup()
{
    redefine_background();

    createCanvas(800, 300);

    var scene1Events = Scene1();
    scenes.push(scene1Events);
}


function draw()
{
    background(); // with no argument will just reuse past background arguments

    scenes[currScene].loop();

    //draw all the sprites
    drawSprites();
}


function mouseClicked()
{

}


function Scene1()
{
    var _events = null;
    
    eval(`

    // ==== begin user code

    background("lightblue");
    var sprite = stamp(100, 100);

    function loop()
    {
       sprite.position.x = mouseX;
       sprite.position.y = mouseY;
    }

    function click()
    {
        show("scene2");
    }

    // ==== end user code

    _events = { loop : loop, click : click };
    `);

    return _events;
}

function Scene2()
{
    background("lightyellow");
    var x = 0;

    function loop()
    {
        line(0, x, 100, x);
        x = x + 1;
    }

    function click()
    {
        show("scene1");
    }

    return { loop : loop, click : click };
}

</script>
