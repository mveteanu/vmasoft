<script src="lib/p5.js"></script>
<script>

p5.prototype.circle = function(x, y, r)
{
    this.ellipse(x, y, r * 2, r * 2);
}

var p;
var g;

function setup()
{
    p = createCanvas(800, 600);

    g = createGraphics(800, 600);
    g.pixelDensity(1);
}

function draw()
{
    drawStaticPicture({ screenBuffer: g});
    image(g, 0, 0);
    //test(g);
}

function mouseMoved()
{
    g.mouseY = mouseY;
    handleMouseMoved({ screenBuffer: g});
}

function handleMouseMoved(buff)
{
    with(buff.screenBuffer)
    {
        console.log(window.mouseX, mouseY);
    }
}

function drawStaticPicture(buff)
{
    let _mouseX = mouseX;
    let _mouseY = mouseY;
    
    with(buff.screenBuffer)
    {
        let mouseX = _mouseX;
        let mouseY = _mouseY;
        
        dostuff();

        function dostuff()
        {
            background("lightblue");
            ellipse(0, 0, 10);
            ellipse(width, 0, 10);
            ellipse(0, height, 10);
            ellipse(width, height, 10);
            circle(width / 2, height /2, 50)

            ellipse(100, 100, 100);
        }
    }
}



</script>

<!--
<pre>

... by wrapping the code with "with" statement... (although it is deprecated)

function drawStaticPicture(screenBuffer)
{
    with(screenBuffer)
    {
        dostuff();

        function dostuff()
        {
            background("lightblue");
            ellipse(0, 0, 10);
            ellipse(width, 0, 10);
            ellipse(0, height, 10);
            ellipse(width, height, 10);
            ellipse(width / 2, height /2, 100);

            ellipse(100, 100, 100);
        }
    }
}

</pre>

... OR ...

<pre>

I should be able to make the Stetch animate sprites also on static scenes, if I put the following
code in the main Sketch -> draw() function (also comment out drawSprite(oSprite); from sprite easy function)

However ... this doesn't work if the sketch scene contains p5.Play calls such as sprite() ... probably p5.Play has some bugs


function Sketch()
{
    var oGraphicsBuffer = null;

    ...

    function draw()
    {
        ...

        if (!currScene.hasEnter && !currScene.hasLoop)
        {
            if (!currScene.enterExecuted)
            {
                oGraphicsBuffer = createGraphics(width, height);
                oGraphicsBuffer.pixelDensity(1);
                bindP5GlobalFunctions(oGraphicsBuffer);
                
                _applySceneBackground(currScene);
                _executeScene(currScene);
                currScene.enterExecuted = true;

                bindP5GlobalFunctions(window);
            }

            image(oGraphicsBuffer, 0, 0);
            _drawSprites(currScene.spritesGroup);
        }

    }


    function bindP5GlobalFunctions(oGraphics)
    {
        for (var p in p5.prototype) 
        {
            if (typeof p5.prototype[p] === 'function') 
            {
                window[p] = p5.prototype[p].bind(oGraphics);
            }
        }
    } 

    ...

}

</pre>

... or a different version...

<pre>


p5.disableFriendlyErrors = true;
var glbFunctions;

...

glbFunctions = collectFunctions();
bindP5GlobalFunctions(g);

background("lightblue");
ellipse(0, 0, 10);
ellipse(width, 0, 10);
ellipse(0, height, 10);
ellipse(width, height, 10);
ellipse(width / 2, height /2, 100);

restoreFunctions(glbFunctions);

...

function collectFunctions()
{
    var o = {};

    for (var p in p5.prototype) 
    {
        if (typeof p5.prototype[p] === 'function') 
        {
            o[p] = window[p]
        }
    }

    return o;
}

function restoreFunctions(o)
{
    for (var p in p5.prototype) 
    {
        if (typeof p5.prototype[p] === 'function') 
        {
            window[p] = o[p];
        }
    }
}


function bindP5GlobalFunctions(oGraphics)
{
    for (var p in p5.prototype) 
    {
        if (typeof p5.prototype[p] === 'function') 
        {
            window[p] = p5.prototype[p].bind(oGraphics);
        }
    }
}

</pre>
-->
